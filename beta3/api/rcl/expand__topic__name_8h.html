<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>rcl: include/rcl/expand_topic_name.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">rcl
   &#160;<span id="projectnumber">master</span>
   </div>
   <div id="projectbrief">C API providing common ROS client library functionality.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_283a3917c54ce6b1b3757c2d5b61678e.html">rcl</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">expand_topic_name.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;rcutils/types/string_map.h&quot;</code><br />
<code>#include &quot;<a class="el" href="allocator_8h_source.html">rcl/allocator.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="macros_8h_source.html">rcl/macros.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="types_8h_source.html">rcl/types.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="visibility__control_8h_source.html">rcl/visibility_control.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for expand_topic_name.h:</div>
<div class="dyncontent">
<div class="center"><img src="expand__topic__name_8h__incl.png" border="0" usemap="#include_2rcl_2expand__topic__name_8h" alt=""/></div>
<map name="include_2rcl_2expand__topic__name_8h" id="include_2rcl_2expand__topic__name_8h">
<area shape="rect" id="node3" href="allocator_8h.html" title="rcl/allocator.h" alt="" coords="159,102,259,129"/>
<area shape="rect" id="node5" href="macros_8h.html" title="rcl/macros.h" alt="" coords="283,102,377,129"/>
<area shape="rect" id="node6" href="types_8h.html" title="rcl/types.h" alt="" coords="402,102,485,129"/>
<area shape="rect" id="node8" href="visibility__control_8h.html" title="rcl/visibility_control.h" alt="" coords="509,102,653,129"/>
</map>
</div>
</div>
<p><a href="expand__topic__name_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:afd76d3899685bd234563afa467b885f2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="types_8h.html#af66ec2e20118b821dbf3f9b0067e8796">rcl_ret_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="expand__topic__name_8h.html#afd76d3899685bd234563afa467b885f2">rcl_expand_topic_name</a> (const char *input_topic_name, const char *node_name, const char *node_namespace, const rcutils_string_map_t *substitutions, <a class="el" href="allocator_8h.html#ac7146d98a03ca836efa0d0d77c78984c">rcl_allocator_t</a> allocator, char **output_topic_name)</td></tr>
<tr class="memdesc:afd76d3899685bd234563afa467b885f2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Expand a given topic name into a fully-qualified topic name.  <a href="#afd76d3899685bd234563afa467b885f2">More...</a><br /></td></tr>
<tr class="separator:afd76d3899685bd234563afa467b885f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab80053300d528559bd6eca210b0a90d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="types_8h.html#af66ec2e20118b821dbf3f9b0067e8796">rcl_ret_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="expand__topic__name_8h.html#aab80053300d528559bd6eca210b0a90d">rcl_get_default_topic_name_substitutions</a> (rcutils_string_map_t *string_map)</td></tr>
<tr class="memdesc:aab80053300d528559bd6eca210b0a90d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Fill a given string map with the default substitution pairs.  <a href="#aab80053300d528559bd6eca210b0a90d">More...</a><br /></td></tr>
<tr class="separator:aab80053300d528559bd6eca210b0a90d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="afd76d3899685bd234563afa467b885f2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="types_8h.html#af66ec2e20118b821dbf3f9b0067e8796">rcl_ret_t</a> rcl_expand_topic_name </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>input_topic_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>node_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>node_namespace</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const rcutils_string_map_t *&#160;</td>
          <td class="paramname"><em>substitutions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="allocator_8h.html#ac7146d98a03ca836efa0d0d77c78984c">rcl_allocator_t</a>&#160;</td>
          <td class="paramname"><em>allocator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>output_topic_name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Expand a given topic name into a fully-qualified topic name. </p>
<p>The input_topic_name, node_name, and node_namespace arguments must all be vaid, null terminated c strings. The output_topic_name will not be assigned a value in the event of an error.</p>
<p>The output_topic_name will be null terminated. It is also allocated, so it needs to be deallocated, when it is no longer needed, with the same allocator given to this function. Make sure the <code>char *</code> which is passed for the output_topic_name does not point to allocated memory before calling this function, because it will be overwritten and therefore leaked if this function is successful.</p>
<p>Expected usage:</p>
<div class="fragment"><div class="line"><a class="code" href="allocator_8h.html#ac7146d98a03ca836efa0d0d77c78984c">rcl_allocator_t</a> allocator = <a class="code" href="allocator_8h.html#a2546f065f55387ed642d455a55ba7602">rcl_get_default_allocator</a>();</div><div class="line">rcutils_allocator_t rcutils_allocator = rcutils_get_default_allocator();</div><div class="line">rcutils_string_map_t substitutions_map = rcutils_get_zero_initialized_string_map();</div><div class="line">rcutils_ret_t rcutils_ret = rcutils_string_map_init(&amp;substitutions_map, 0, rcutils_allocator);</div><div class="line"><span class="keywordflow">if</span> (rcutils_ret != RCUTILS_RET_OK) {</div><div class="line">  <span class="comment">// ... error handling</span></div><div class="line">}</div><div class="line"><a class="code" href="types_8h.html#af66ec2e20118b821dbf3f9b0067e8796">rcl_ret_t</a> ret = <a class="code" href="expand__topic__name_8h.html#aab80053300d528559bd6eca210b0a90d">rcl_get_default_topic_name_substitutions</a>(&amp;substitutions_map);</div><div class="line"><span class="keywordflow">if</span> (ret != <a class="code" href="types_8h.html#a94bb3f9182050c163281f5c1ebe647f4">RCL_RET_OK</a>) {</div><div class="line">  <span class="comment">// ... error handling</span></div><div class="line">}</div><div class="line"><span class="keywordtype">char</span> * expanded_topic_name = NULL;</div><div class="line">ret = <a class="code" href="expand__topic__name_8h.html#afd76d3899685bd234563afa467b885f2">rcl_expand_topic_name</a>(</div><div class="line">  <span class="stringliteral">&quot;some/topic&quot;</span>,</div><div class="line">  <span class="stringliteral">&quot;my_node&quot;</span>,</div><div class="line">  <span class="stringliteral">&quot;my_ns&quot;</span>,</div><div class="line">  &amp;substitutions_map,</div><div class="line">  allocator,</div><div class="line">  &amp;expanded_topic_name);</div><div class="line"><span class="keywordflow">if</span> (ret != <a class="code" href="types_8h.html#a94bb3f9182050c163281f5c1ebe647f4">RCL_RET_OK</a>) {</div><div class="line">  <span class="comment">// ... error handling</span></div><div class="line">} <span class="keywordflow">else</span> {</div><div class="line">  RCUTILS_LOG_INFO(<span class="stringliteral">&quot;Expanded topic name: %s&quot;</span>, expanded_topic_name)</div><div class="line">  <span class="comment">// ... when done the output topic name needs to be deallocated:</span></div><div class="line">  allocator.deallocate(expanded_topic_name, allocator.state);</div><div class="line">}</div></div><!-- fragment --><p>The input topic name is validated using <a class="el" href="validate__topic__name_8h.html#a20c545f9fb74259483ecdcd6a4ad3232" title="Validate a given topic name. ">rcl_validate_topic_name()</a>, but if it fails validation RCL_RET_TOPIC_NAME_INVALID is returned.</p>
<p>The input node name is validated using rmw_validate_node_name(), but if it fails validation RCL_RET_NODE_INVALID_NAME is returned.</p>
<p>The input node namespace is validated using rmw_validate_namespace(), but if it fails validation RCL_RET_NODE_INVALID_NAMESPACE is returned.</p>
<p>In addition to what is given by <a class="el" href="expand__topic__name_8h.html#aab80053300d528559bd6eca210b0a90d" title="Fill a given string map with the default substitution pairs. ">rcl_get_default_topic_name_substitutions()</a>, there are there these substitutions:</p>
<ul>
<li>{node} -&gt; the name of the node</li>
<li>{namespace} -&gt; the namespace of the node</li>
<li>{ns} -&gt; the namespace of the node</li>
</ul>
<p>If an unknown substitution is used, RCL_RET_UNKNOWN_SUBSTITUTION is returned.</p>
<hr/>
 <table class="doxtable">
<tr>
<th>Attribute </th><th>Adherence  </th></tr>
<tr>
<td>Allocates Memory </td><td>Yes </td></tr>
<tr>
<td>Thread-Safe </td><td>No </td></tr>
<tr>
<td>Uses Atomics </td><td>No </td></tr>
<tr>
<td>Lock-Free </td><td>Yes </td></tr>
</table>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">input_topic_name</td><td>topic name to be expanded </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">node_name</td><td>name of the node associated with the topic </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">node_namespace</td><td>namespace of the node associated with the topic </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">substitutions</td><td>string map with possible substitutions </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">allocator</td><td>the allocator to be used when creating the output topic </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">output_topic_name</td><td>output char * pointer </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>RCL_RET_OK</code> if the topic name was expanded successfully, or </dd>
<dd>
<code>RCL_RET_INVALID_ARGUMENT</code> if any arguments are invalid, or </dd>
<dd>
<code>RCL_RET_BAD_ALLOC</code> if allocating memory failed, or </dd>
<dd>
<code>RCL_RET_TOPIC_NAME_INVALID</code> if the given topic name is invalid, or </dd>
<dd>
<code>RCL_RET_NODE_INVALID_NAME</code> if the name is invalid, or </dd>
<dd>
<code>RCL_RET_NODE_INVALID_NAMESPACE</code> if the namespace_ is invalid, or </dd>
<dd>
<code>RCL_RET_UNKNOWN_SUBSTITUTION</code> for unknown substitutions in name, or </dd>
<dd>
<code>RCL_RET_ERROR</code> if an unspecified error occurs. </dd></dl>

</div>
</div>
<a class="anchor" id="aab80053300d528559bd6eca210b0a90d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="types_8h.html#af66ec2e20118b821dbf3f9b0067e8796">rcl_ret_t</a> rcl_get_default_topic_name_substitutions </td>
          <td>(</td>
          <td class="paramtype">rcutils_string_map_t *&#160;</td>
          <td class="paramname"><em>string_map</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Fill a given string map with the default substitution pairs. </p>
<p>If the string map is not initialized RCL_RET_INVALID_ARGUMENT is returned.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">string_map</td><td>rcutils_string_map_t map to be filled with pairs </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>RCL_RET_OK</code> if successfully, or </dd>
<dd>
<code>RCL_RET_INVALID_ARGUMENT</code> if any arguments are invalid, or </dd>
<dd>
<code>RCL_RET_BAD_ALLOC</code> if allocating memory failed, or </dd>
<dd>
<code>RCL_RET_ERROR</code> if an unspecified error occurs. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
